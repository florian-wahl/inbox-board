import{r,R as w,j as e,B as s,T as t,H as P,J as l,N as C,G as m,O as W,Q as A,U as I,V as h,W as M,X as S}from"./mui-vendor-EY2v0Zuk.js";import{u as z,b as F,g as N,s as U,p as L,c as G}from"./index-omMUvaP9.js";import"./react-vendor-Csw2ODfV.js";import"./dexie-vendor-DmXeiz56.js";import"./utils-vendor-D2KzgrTC.js";import"./router-vendor-fLdkdyln.js";const Z=()=>{const[x,p]=r.useState(!1),[u,c]=r.useState(null),[b,y]=r.useState(!1),[d,g]=r.useState(null),{reload:D}=z(),{theme:E,setTheme:B}=F(),[n,j]=r.useState(30),[o,f]=r.useState(15),[i,v]=r.useState(!0);w.useEffect(()=>{(async()=>{const a=await N();a&&(j(a.batchSize??20),f(a.dateRange??30),v(a.settings?.showProgressBar??!0))})()},[]),w.useEffect(()=>{U({batchSize:n,dateRange:o,settings:{showProgressBar:i}})},[n,o,i]);const R=async()=>{if(window.confirm("Are you sure you want to purge all data? This will remove all emails, subscriptions, and orders. This action cannot be undone.")){p(!0),c(null);try{await G(),c("Database purged successfully!")}catch(a){c("Error purging database. Please try again."),console.error("Purge error:",a)}finally{p(!1)}}},k=async()=>{if(window.confirm("Are you sure you want to purge all email data? This will remove all emails, subscriptions, and orders, but keep your login token. This action cannot be undone.")){y(!0),g(null);try{await L(),g("Email data purged successfully!")}catch(a){g("Error purging email data. Please try again."),console.error("Purge email data error:",a)}finally{y(!1)}}},T=async()=>{await D(n,o,i)};return e.jsxs(s,{children:[e.jsx(t,{variant:"h4",gutterBottom:!0,children:"Settings"}),e.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:3},children:[e.jsx(s,{sx:{width:"100%",maxWidth:800},children:e.jsxs(s,{sx:{p:2,border:"1px solid #ddd",borderRadius:1},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,sx:{mt:3},children:"Sync Settings"}),e.jsx(P,{fullWidth:!0,label:"Batch Size",type:"number",margin:"normal",value:n,onChange:a=>j(Number(a.target.value)),inputProps:{min:1,max:100}}),e.jsx(P,{fullWidth:!0,label:"Date Range (days)",type:"number",margin:"normal",value:o,onChange:a=>f(Number(a.target.value)),inputProps:{min:1,max:365}}),e.jsx(l,{control:e.jsx(C,{checked:i,onChange:a=>v(a.target.checked)}),label:"Show progress bar during email loading"}),e.jsx(s,{sx:{mt:2},children:e.jsx(m,{variant:"contained",color:"primary",onClick:T,children:"Reload Emails with New Settings"})}),e.jsx(t,{variant:"h6",gutterBottom:!0,sx:{mt:3},children:"Appearance"}),e.jsxs(W,{component:"fieldset",sx:{mb:2},children:[e.jsx(A,{component:"legend",children:"Theme"}),e.jsxs(I,{row:!0,value:E,onChange:a=>B(a.target.value),name:"theme-mode",children:[e.jsx(l,{value:"light",control:e.jsx(h,{}),label:"Light"}),e.jsx(l,{value:"dark",control:e.jsx(h,{}),label:"Dark"}),e.jsx(l,{value:"system",control:e.jsx(h,{}),label:"System"})]})]})]})}),e.jsx(s,{sx:{width:"100%",maxWidth:800},children:e.jsxs(s,{sx:{p:2,border:"1px solid #ddd",borderRadius:1},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Database Management"}),e.jsx(M,{sx:{my:2}}),e.jsx(t,{variant:"subtitle1",gutterBottom:!0,color:"error",children:"Danger Zone"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"This will permanently delete all stored emails, subscriptions, and orders from your device, but keep your login token."}),e.jsx(m,{variant:"contained",color:"warning",onClick:k,disabled:b,sx:{mb:2},children:b?"Purging Email Data...":"Purge Email Data"}),d&&e.jsx(S,{severity:d.includes("Error")?"error":"success",sx:{mt:2},children:d}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"This will permanently delete all stored emails, subscriptions, orders, and login tokens from your device."}),e.jsx(m,{variant:"contained",color:"error",onClick:R,disabled:x,children:x?"Purging...":"Purge All Data"}),u&&e.jsx(S,{severity:u.includes("Error")?"error":"success",sx:{mt:2},children:u})]})})]})]})};export{Z as default};
